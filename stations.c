/*
This file contains a list of stations as well a lookup routine that
uses binary search 
*/

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "ray.h"

#define NSTAT 107 
Station statList[NSTAT] = { 
 "ada",0, 65.01879, -15.57452, 0.443,
 "aku",0, 65.68574, -18.09987, 0.028,
 "alf",0, 63.49104, -19.18440, 0.132,
 "asb",0, 64.74818, -21.32535, 0.094,
 "ask",0, 65.05192, -16.64819, 0.955,
 "asm",0, 63.83361, -20.61474, 0.022,
 "aso",0, 63.59656, -19.73110, 0.673,
 "aus",0, 63.67231, -19.08079, 1.373,
 "bar",0, 64.64017, -17.44633, 1.890,
 "bas",0, 63.67570, -19.47592, 0.300,
 "bja",0, 63.94590, -21.30258, 0.057,
 "bjk",0, 64.46898, -16.75247, 1.572,
 "bre",0, 66.12336, -17.90967, 0.041,
 "bru",0, 64.82886, -16.08850, 0.751,
 "bsr",0, 63.68,    -19.53,    0.2,
 "dim",0, 65.96151, -16.93192, 0.266,
 "djk",0, 64.50405, -17.23571, 1.683,
 "dyn",0, 64.79086, -17.36626, 1.209,
 "eda",0, 64.08258, -21.38898, 0.264,
 "eng",0, 64.08782, -21.41042, 0.271,
 "ent",0, 63.70102, -19.18226, 1.355,
 "esk",0, 63.52503, -19.45080, 0.095,
 "fag",0, 63.87478, -16.65364, 0.027,
 "fed",0, 64.02508, -19.69086, 0.432,
 "fla",0, 66.16069, -17.84750, 0.013,
 "fsb",0, 63.68,    -19.56,    0.2,
 "gfl",0, 63.52645, -19.11001, 0.735,
 "gha",0, 65.84346, -16.66291, 0.396,
 "ghs",0, 65.85778, -16.62721, 0.405,
 "gij",0, 63.68,    -19.59,    0.2,
 "gil",0, 66.07734, -16.35131, 0.134,
 "glu",0, 64.98064, -15.08544, 0.115,
 "god",0, 63.65976, -19.32236, 1.200,
 "gra",0, 65.91760, -17.57855, 0.024,
 "grf",0, 64.40656, -17.26713, 1.710,
 "gri",0, 66.54152, -18.00951, 0.036,
 "grs",0, 65.63811, -16.12409, 0.378,
 "grv",0, 63.85716, -22.45583, 0.052,
 "gyg",0, 64.28107, -20.21483, 0.119,
 "hae",0, 64.02611, -16.98858, 0.263,
 "haf",0, 64.04257, -21.91870, 0.070,
 "ham",0, 64.48020, -17.82229, 1.560,
 "hau",0, 63.96851, -19.96471, 0.096,
 "hed",0, 66.08080, -17.30975, 0.075,
 "hei",0, 64.19978, -21.23604, 0.162,
 "hes",0, 64.04680, -19.56040, 0.529,
 "hla",0, 65.94441, -18.38724, 0.037,
 "hra",0, 63.95619, -19.21498, 0.896,
 "hrn",0, 66.11000, -20.12252, 0.015,
 "hus",0, 64.29550, -17.65650, 1.314,
 "hva",0, 64.95473, -15.86928, 0.703,
 "hve",0, 64.86979, -19.56661, 0.640,
 "hvo",0, 63.52610, -18.84781, 0.196,
 "iey",0, 64.09534, -18.12391, 0.652,
 "jok",0, 64.31529, -18.22546, 0.736,
 "kal",0, 63.94761, -17.68698, 0.078,
 "kas",0, 64.02290, -21.85200, 0.108,
 "kis",0, 64.67413, -17.56167, 1.567,
 "kre",0, 64.78369, -16.38282, 0.760,
 "kri",0, 63.87810, -22.07646, 0.146,
 "kro",0, 64.09806, -21.11976, 0.147,
 "ksk",0, 64.16130, -16.47370, 0.940,
 "kud",0, 64.32059, -21.87472, 0.028,
 "kve",0, 64.67805, -16.67751, 1.786,
 "kvo",0, 65.71392, -16.88130, 0.572,
 "lei",0, 66.40665, -16.48957, 0.041,
 "lod",0, 63.73440, -18.79094, 0.402,
 "mel",0, 65.57002, -16.65725, 0.370,
 "mid",0, 63.65833, -19.88573, 0.132,
 "mjo",0, 63.93295, -19.67238, 0.704,
 "mko",0, 64.97840, -16.33826, 0.690,
 "mok",0, 64.97784, -16.33909, 0.660,
 "npa",0, 63.67,    -19.90,    0.2,
 "nyl",0, 63.97368, -22.73792, 0.007,
 "ren",0, 65.64699, -16.90591, 0.338,
 "rey",0, 64.12765, -21.90397, 0.053,
 "rju",0, 63.61745, -18.67210, 0.173,
 "rne",0, 63.81681, -22.70563, 0.019,
 "san",0, 64.05601, -21.57013, 0.208,
 "sau",0, 63.98983, -20.41519, 0.074,
 "sig",0, 66.13229, -18.91483, 0.010,
 "sjv",0, 63.54,    -19.55,    0.2,
 "skh",0, 63.45347, -19.09453, 0.070,
 "ski",0, 65.86982, -17.02696, 0.316,
 "skr",0, 64.56014, -18.38647, 0.858,
 "sly",0, 63.82402, -19.11732, 0.633,
 "smj",0, 64.67587, -19.65784, 0.211,
 "sn0",0, 64.77691, -23.67578, 0.216,
 "sn1",0, 64.79362, -23.88176, 0.139,
 "sn2",0, 64.89157, -23.92290, 0.067,
 "sn3",0, 64.87806, -23.70616, 0.246,
 "sn4",0, 65.00844, -22.53364, 0.062,
 "snb",0, 63.73637, -18.63068, 0.245,
 "sol",0, 63.92896, -20.94357, 0.030,
 "ste",0, 64.85590, -19.62750, 0.740,
 "sva",0, 65.33691, -17.25454, 0.403,
 "tho",0, 64.93372, -16.67558, 0.691,
 "urh",0, 64.82037, -17.14712, 1.078,
 "vat",0, 64.18664, -18.91768, 0.573,
 "ves",0, 63.44291, -20.28664, 0.055,
 "vme",0, 63.42700, -20.29389, 0.076,
 "vog",0, 63.96967, -22.39285, 0.007,
 "von",0, 64.67322, -17.75582, 0.999,
 "vos",0, 63.85279, -21.70357, 0.008,
 "vot",0, 64.27081, -17.18254, 1.041,
 "vsh",0, 64.80775, -15.72768, 0.860,
 "zzz",0, 65.0    , -19.0    , 1.   
}  ;

Station *lookUpStation( char *name ) 
{
	Station *p0, *pp, *p1 ;
	int test ;
	p0 = statList ;
	p1 = statList + (NSTAT - 1 ) ;
	while ( p0 < p1 ) {
		pp = p0 + ( p1 - p0)/2 ;
#ifdef TEST
		printf("%s %s %s %s %2d %2d %2d\n",name,p0->name,pp->name,p1->name,
			p0-statList,pp-statList,p1-statList) ; 
#endif
		test = strcmp(pp->name,name) ;
		if( 0 == test ) {
			pp->useCount++ ;
			return pp ;
		}
		if( test > 0 ) p1 = pp ;
		else p0 = pp+1 ;
	}
	rLog(-1,"station name %s not found", (void *) name ) ;
	return NULL ;
}
void clearStationCount() 
{
	int i ;
	for( i = 0 ; i < NSTAT-1 ; i++) statList[i].useCount = 0 ;
}
void listStations( FILE *ff, char *prefix )
{
	int i ;
	Station a;
	for( i = 0 ; i < NSTAT-1 ; i++) {
		a = statList[i] ;
		if(a.useCount > 0 ) 
		  fprintf(ff,"%s %s %10.5f %10.5f %4d\n",
			prefix,a.name,a.lat,a.lon,a.useCount) ;
	}
}

#ifdef TEST
int main()
{
	Station a, *ap ;
	int i ;
	a = statList[3] ;
	printf("%s %f %f %f\n",a.name,a.lat,a.lon,a.depth) ;
	for( i = 0 ; i < NSTAT-1 ; i++) {
		ap =  lookUpStation(statList[i].name) ;
		printf("%s %f %f %f\n",ap->name,ap->lat,ap->lon,ap->depth) ;
	}
	for( i = 0 ; i < NSTAT-1 ; i++) {
		a=statList[i] ;
		printf("%f %f %4d\n",a.lon,a.lat,a.useCount) ;
	}
	listStations(stdout,"BOO") ;
	return 0 ;
}
#endif
